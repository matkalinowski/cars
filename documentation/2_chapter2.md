# Chapter 2

asdasdasd

![cat](img/sample_img.png)


## 2.1 The chapter about table <a name="ch21"></a>

|ID  |train_loss       |valid_loss      |train_acc      |valid_acc        |
|----|-----------------|----------------|---------------|-----------------|
|C-66|1.05705642700195 |1.94232738018036|0.9871826171875|0.70460706949234 |
|C-65|0.975141584873199|1.90740954875946|0.99658203125  |0.73066383600235 |
|C-64|1.16944646835327 |2.31413674354553|0.98486328125  |0.606967449188232|
|C-63|0.993828892707825|2.03852033615112|0.998046875    |0.705063760280609|
|C-58|1.04952955245972 |1.72010517120361|0.994384765625 |0.788288176059723|
|C-56|1.06607270240784 |1.55965912342072|0.9898681640625|0.82785576581955 |
|C-55|1.07006275653839 |1.52582192420959|0.98779296875  |0.837216913700104|
|C-53|1.07345962524414 |1.52983939647675|0.9896240234375|0.830172657966614|
|C-51|1.07659065723419 |1.57192063331604|0.9886474609375|0.825445234775543|
|C-50|1.06406927108765 |1.52079606056213|0.9893798828125|0.837945818901062|
|C-48|1.30320715904236 |1.63295352458954|0.936767578125 |0.805649280548096|
|C-47|1.16913282871246 |1.62952435016632|0.9742431640625|0.802207350730896|
|C-46|1.20293843746185 |1.72070729732513|0.9703369140625|0.78253847360611 |
|C-45|1.16190898418427 |1.69912981987   |0.9755859375   |0.78732031583786 |
|C-44|1.08713054656982 |1.56150114536285|0.9879150390625|0.824513614177704|
|C-43|1.26952600479126 |1.69178748130798|0.9608154296875|0.778709352016449|
|C-42|1.27010464668274 |1.64642894268036|0.953369140625 |0.795659124851227|
|C-41|1.11071968078613 |1.57100081443787|0.98486328125  |0.820847868919373|
|C-40|1.08898746967316 |1.80184423923492|0.992431640625 |0.751249134540558|
|C-39|1.08975172042847 |1.56349182128906|0.9866943359375|0.825490534305573|
|C-38|1.04828071594238 |1.69521152973175|0.99365234375  |0.788203537464142|
|C-37|1.04311966896057 |1.85827875137329|0.9957275390625|0.744359135627747|
|C-36|1.10257422924042 |1.6685152053833 |0.9884033203125|0.794016778469086|
|C-33|1.05852210521698 |1.97054314613342|0.9959716796875|0.715852439403534|
|C-32|1.14247417449951 |2.02211022377014|0.98681640625  |0.687935531139374|
|C-31|1.32133591175079 |2.13034391403198|0.9503173828125|0.649269223213196|
|C-30|1.74917757511139 |2.36378931999207|0.806640625    |0.578212678432465|
|C-29|1.00563597679138 |1.87429106235504|0.997802734375 |0.748218536376953|
|C-28|0.987768411636352|1.88813841342926|0.998291015625 |0.751427590847015|
|C-27|1.01401126384735 |1.83573400974274|0.997802734375 |0.762022733688355|
|C-26|0.994776010513306|1.90259552001953|0.9981689453125|0.746040821075439|
|C-25|1.07087171077728 |2.29374861717224|0.9898681640625|0.631085455417633|
|C-24|1.10818934440613 |2.20230484008789|0.9822998046875|0.649647295475006|
|C-23|1.19577646255493 |2.25025200843811|0.9613037109375|0.631263911724091|
|C-22|1.13956415653229 |2.05464220046997|0.9713134765625|0.68928450345993 |
|C-21|1.19106125831604 |2.09555220603943|0.9627685546875|0.66751354932785 |
|C-20|1.1732292175293  |2.16350102424622|0.9652099609375|0.648833751678467|
|C-19|1.08666849136353 |2.10761165618896|0.9862060546875|0.678069353103638|
|C-18|1.03900241851807 |2.17926597595215|0.9910888671875|0.668962299823761|
|C-17|1.37830400466919 |2.30149102210999|0.90380859375  |0.599457383155823|
|C-16|1.19275617599487 |2.17368698120117|0.95947265625  |0.651422798633575|
|C-15|1.21316075325012 |2.28454923629761|0.958251953125 |0.618391275405884|
|C-14|1.07060635089874 |2.08878469467163|0.9884033203125|0.684968411922455|
|C-13|1.02339673042297 |2.31456589698791|0.994384765625 |0.633922517299652|
|C-12|1.01693415641785 |2.84319567680359|0.9967041015625|0.505087375640869|
|C-11|4.82231426239014 |5.19569873809814|0.0435791015625|0.030699525028467|
|C-10|4.5696759223938  |5.14197254180908|0.0758056640625|0.039077620953322|
|C-9 |1.20707583427429 |4.74564218521118|0.9713134765625|0.086757160723209|
|C-8 |1.08910536766052 |5.08039617538452|0.994873046875 |0.065814942121506|
|C-7 |1.00337648391724 |2.74435448646545|0.997314453125 |0.542761564254761|
|C-6 |1.31481122970581 |3.45237612724304|0.936767578125 |0.386792868375778|
|C-5 |1.12226414680481 |3.33859324455261|0.981201171875 |0.380770921707153|
|C-4 |0.98966521024704 |2.8108332157135 |0.99755859375  |0.519248485565185|
|C-3 |1.07505440711975 |4.79199552536011|0.9945068359375|0.119604140520096|
|C-2 |1.13285481929779 |4.87297534942627|0.9888916015625|0.091230519115925|
|C-1 |0.296121209859848|4.84898328781128|0.9249267578125|0.081503458321095|


## 2.2 Config chapter <a name="ch22"></a>

This is `yaml` config:

```yaml
# Logging settings:
loglevel: 'INFO'
logging_dir: 'logs'
log_to_neptune: False
neptune_username: '<neptune.ai username>'
neptune_project_name: '<neptune.ai project name>'
neptune_api_token: '<neptune.ai API token>'

# Train/test dataset and devkit location
stanford_raw_data_path: '<path to the folder containing: car_ims.tgz, cars_annos.mat, car_devkit.tgz>'
stanford_data_path: 'input/stanford'

# Output settings
output_path: 'output'

# General data preprocessinng settings
image_size: &img_size [227, 227]  # Anchor to use in augmentations if needed
convert_to_grayscale: False
normalize: True  
normalization_params_rgb:  # Applied when 'convert_to_grayscale==False'
  mean: [0.4707, 0.4602, 0.4550]
  std: [0.2594, 0.2585, 0.2635]
normalization_params_grayscale:  # Applied when 'convert_to_grayscale==True'
  mean: [0.4627]
  std: [0.2545]

# Training data augmentation settings
crop_to_bboxes: True  # crop training images using bounding boxes
erase_background: True  # erase background outside bboxes to preserve ratios (only if 'crop_to_bboxes==True') 
augment_images: True
image_augmentations:  # to be applied consecutively
  RandomHorizontalFlip:  # has to be a valid transformation from 'torchvision.transforms'
    p: 0.5  # transformation parameters to be passed as '**dict'
  RandomAffine:
    degrees: 25
    translate: [0.1, 0.1]
    scale: [0.9, 1.1]
    shear: 8
  ColorJitter:
    brightness: 0.2
    contrast: 0.2
    saturation: 0.2
    hue: 0.1
augment_tensors: True
tensor_augmentations:  # to be applied consecutively
  RandomErasing:
    p: 0.5
    scale: [0.02, 0.25]

# Network and training settings
architecture: 'ghost'  # Possible options in 'models.arch_dict'
batch_size: 64
num_epochs: 200

# Architecture modifications (right now GhostNet only!)
dropout: 0.2  # droupout rate before the last Linear layer
output_channels: 320  # output channels to be mapped to the number of classes

# Optimizer settings
optimizer: AdamW  # valid optimizer from 'torch.optim'
optimizer_params:
  lr: 0.001
  weight_decay: 0.6
lr_scheduler: ReduceLROnPlateau  # # valid lr_scheduler from 'torch.optim' or None
lr_scheduler_params:  # scheduler parameters to be passed as '**dict'
  factor: 0.1
  patience: 5
  threshold: 0.001
  min_lr: 0.0000001

# Loss function settings
loss_function: LabelSmoothingCrossEntropy  # valid loss function from 'torch.nn' or custom LabelSmoothingCrossEntropy
loss_params:  # loss parameters to be passed as '**dict'
```